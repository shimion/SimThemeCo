!function(e){e.fn.richText=function(t){function a(){var t,a,n="";R.useParagraph!==!1&&document.execCommand("DefaultParagraphSeparator",!1,"p"),"TEXTAREA"===S.prop("tagName")||(S.val()?(t=S.val(),a=S.prop("attributes"),e.each(a,function(){this.name&&(n+=" "+this.name+'="'+this.value+'"')}),S.replaceWith(e("<textarea"+n+' data-richtext="init">'+t+"</textarea>")),S=e('[data-richtext="init"]'),S.removeAttr("data-richtext")):S.html()?(t=S.html(),a=S.prop("attributes"),e.each(a,function(){this.name&&(n+=" "+this.name+'="'+this.value+'"')}),S.replaceWith(e("<textarea"+n+' data-richtext="init">'+t+"</textarea>")),S=e('[data-richtext="init"]'),S.removeAttr("data-richtext")):(a=S.prop("attributes"),e.each(a,function(){this.name&&(n+=" "+this.name+'="'+this.value+'"')}),S.replaceWith(e("<textarea"+n+' data-richtext="init"></textarea>')),S=e('[data-richtext="init"]'),S.removeAttr("data-richtext"))),k=e("<div />",{"class":"richText"});var i=e("<div />",{"class":"richText-toolbar"}),r=e("<div />",{"class":"richText-editor",id:re,contenteditable:!0});if(i.append(U),R.bold===!0&&U.append(D.clone().append(A)),R.italic===!0&&U.append(D.clone().append(F)),R.underline===!0&&U.append(D.clone().append(H)),R.leftAlign===!0&&U.append(D.clone().append(I)),R.centerAlign===!0&&U.append(D.clone().append(M)),R.rightAlign===!0&&U.append(D.clone().append(B)),R.ol===!0&&U.append(D.clone().append(E)),R.ul===!0&&U.append(D.clone().append(P)),R.fonts===!0&&R.fontList.length>0&&U.append(D.clone().append(X)),R.heading===!0&&U.append(D.clone().append(W)),R.fontColor===!0&&U.append(D.clone().append(Y)),R.imageUpload===!0&&U.append(D.clone().append(Q)),R.fileUpload===!0&&U.append(D.clone().append(G)),R.videoEmbed===!0&&U.append(D.clone().append(z)),R.urls===!0&&U.append(D.clone().append(_)),R.table===!0&&U.append(D.clone().append(V)),R.removeStyles===!0&&U.append(D.clone().append(O)),R.code===!0&&U.append(D.clone().append(j)),r.html(S.val()),k.append(i),k.append(r),k.append(S.clone().hide()),S.replaceWith(k),k.append(e("<div />",{"class":"richText-toolbar"}).append(e("<a />",{"class":"richText-undo is-disabled",html:'<span class="fa fa-undo"></span>'})).append(e("<a />",{"class":"richText-redo is-disabled",html:'<span class="fa fa-repeat"></span>'})).append(e("<a />",{"class":"richText-help",html:'<span class="fa fa-question-circle"></span>'}))),R.height&&R.height>0)k.children(".richText-editor, .richText-initial").css({"min-height":R.height+"px",height:R.height+"px"});else if(R.heightPercentage&&R.heightPercentage>0){var o=k.parent().innerHeight(),l=R.heightPercentage/100*o;l-=2*i.outerHeight(),l-=parseInt(k.css("margin-top")),l-=parseInt(k.css("margin-bottom")),l-=parseInt(k.find(".richText-editor").css("padding-top")),l-=parseInt(k.find(".richText-editor").css("padding-bottom")),k.children(".richText-editor, .richText-initial").css({"min-height":l+"px",height:l+"px"})}R["class"]&&k.addClass(R["class"]),R.id&&k.attr("id",R.id),y(),le.push(k.find("textarea").val())}function n(e,t){"undefined"==typeof t&&(t=null),m(),"heading"===e&&s()?g("<"+t+">"+s()+"</"+t+">"):document.execCommand(e,!1,t)}function i(){var t=e("#"+re),a=t.html();R.useSingleQuotes===!0&&(a=v(a)),t.siblings(".richText-initial").val(a)}function r(t){var a=e("#"+t),n=a.siblings(".richText-initial").val();a.html(n)}function o(t){var a,n,i,r,o=document.getElementById(t);if(window.getSelection&&document.createRange){var l=window.getSelection&&window.getSelection();if(l&&l.rangeCount>0&&e(l.anchorNode).parents("#"+t).length>0){var a=window.getSelection().getRangeAt(0),d=a.cloneRange();return d.selectNodeContents(o),d.setEnd(a.startContainer,a.startOffset),n=d.toString().length,i=n+a.toString().length,r=n===i?"caret":"selection",anchor="caret"===r&&l.anchorNode.tagName?l.anchorNode:!1,n="caret"===r&&anchor!==!1?0:d.toString().length,i="caret"===r&&anchor!==!1?0:n+a.toString().length,{start:n,end:i,type:r,anchor:anchor,editorID:t}}}return L?L:{start:0,end:0}}function l(e){var t=document.getElementById(e),a=L;if(a.editorID!==e)return!1;if(t=a.anchor?a.anchor:t,window.getSelection&&document.createRange){var n=0,i=document.createRange();if(!i||!t)return window.getSelection().removeAllRanges(),!0;i.setStart(t,0),i.collapse(!0);for(var r,o=[t],l=!1,d=!1;!d&&(r=o.pop());)if(3===r.nodeType){var s=n+r.length;!l&&a.start>=n&&a.start<=s&&(i.setStart(r,a.start-n),l=!0),l&&a.end>=n&&a.end<=s&&(i.setEnd(r,a.end-n),d=!0),n=s}else for(var c=r.childNodes.length;c--;)o.push(r.childNodes[c]);var p=window.getSelection();p.removeAllRanges(),p.addRange(i)}}function d(t,a){if(9!==a.keyCode)return!1;var n;if(t.getSelection&&(n=t.getSelection(),n.rangeCount>0)){var i=null,r=null;if(a.shiftKey?(r="previous",i="TD"===n.focusNode.nodeName?null!=n.focusNode.previousSibling?n.focusNode.previousSibling:null!=n.focusNode.parentNode.previousSibling?n.focusNode.parentNode.previousSibling.childNodes[n.focusNode.parentNode.previousSibling.childNodes.length-1]:null:null!=n.focusNode.parentNode.previousSibling?n.focusNode.parentNode.previousSibling:null!=n.focusNode.parentNode.parentNode.previousSibling?n.focusNode.parentNode.parentNode.previousSibling.childNodes[n.focusNode.parentNode.parentNode.previousSibling.childNodes.length-1]:null):(r="next",i="TD"===n.focusNode.nodeName?null!=n.focusNode.nextSibling?n.focusNode.nextSibling:null!=n.focusNode.parentNode.nextSibling?n.focusNode.parentNode.nextSibling.childNodes[0]:null:null!=n.focusNode.parentNode.nextSibling?n.focusNode.parentNode.nextSibling:null!=n.focusNode.parentNode.parentNode.nextSibling?n.focusNode.parentNode.parentNode.nextSibling.childNodes[0]:null),null!=i)return n.collapse(i,Math.min(i.length,n.focusOffset+1)),null!=i.textContent&&n.selectAllChildren(i),a.preventDefault(),!0;if(null===i&&"next"===r&&"TD"===n.focusNode.nodeName){for(var o=e(n.focusNode).parents("table"),l=o.find("tr").first().children("td").length,s=e("<tr />"),c=e("<td />"),p=1;l>=p;p++)s.append(c.clone());o.append(s),d(window,{keyCode:9,shiftKey:!1,preventDefault:function(){}})}}return!1}function s(){var e;return window.getSelection?(e=window.getSelection(),e.toString()):document.selection.createRange?(e=document.selection.createRange(),e.text):!1}function c(t){var a=e(".richText-editor#"+t).siblings(".richText-initial");p(a.val()),L=o(t)}function p(e){le.length-1>de&&(le.length=de+1),le[le.length-1]!==e&&le.push(e),de=le.length-1,h()}function h(){0>=de?k.find(".richText-undo").addClass("is-disabled"):k.find(".richText-undo").removeClass("is-disabled"),de>=le.length-1||0===le.length?k.find(".richText-redo").addClass("is-disabled"):k.find(".richText-redo").removeClass("is-disabled")}function f(){de--;var e=le[de];k.find("textarea").val(e),k.find(".richText-editor").html(e),h()}function u(){de++;var e=le[de];k.find("textarea").val(e),k.find(".richText-editor").html(e),h()}function m(){L&&l(L.editorID)}function g(e){var t,a;if(window.getSelection){if(t=window.getSelection(),t.getRangeAt&&t.rangeCount){a=t.getRangeAt(0),a.deleteContents();var n=document.createElement("div");n.innerHTML=e;for(var i,r,o=document.createDocumentFragment();i=n.firstChild;)r=o.appendChild(i);a.insertNode(o),r&&(a=a.cloneRange(),a.setStartAfter(r),a.collapse(!0),t.removeAllRanges(),t.addRange(a))}}else document.selection&&"Control"!==document.selection.type&&document.selection.createRange().pasteHTML(e)}function v(e){if(!e)return"";var t,a;return R.useSingleQuotes===!0?(t=/\s+(\w+\s*=\s*(["][^"]*["])|(['][^']*[']))+/g,a=e.replace(t,function(e,t,a){return a?e.replace(a,a.replace(/\"/g,"'")):e})):(t=/\s+(\w+\s*=\s*(['][^']*['])|(["][^"]*["]))+/g,a=e.replace(t,function(e,t,a){return a?e.replace(a,a.replace(/'/g,'"')):e})),a}function x(e){var t=[],a="";t["#FFFFFF"]="White",t["#000000"]="Black",t["#7F6000"]="Brown",t["#938953"]="Beige",t["#1F497D"]="Dark Blue",t.blue="Blue",t["#4F81BD"]="Light blue",t["#953734"]="Dark red",t.red="Red",t["#4F6128"]="Dark green",t.green="Green",t["#3F3151"]="Purple",t["#31859B"]="Dark Turquois",t["#4BACC6"]="Turquois",t["#E36C09"]="Dark orange",t["#F79646"]="Orange",t["#FFFF00"]="Yellow",R.colors&&R.colors.length>0&&(t=R.colors);for(var n in t)a+='<li class="inline"><a data-command="'+e+'" data-option="'+n+'" style="text-align:left;" title="'+t[n]+'"><span class="box-color" style="background-color:'+n+'"></span></a></li>';return a}function T(t){m(),k.find(".richText-editor").is(":visible")?(k.find(".richText-initial").show(),k.find(".richText-editor").hide(),e(".richText-toolbar").find(".richText-btn").each(function(){e(this).hasClass("fa-code")||e(this).parent("li").attr("data-disable","true")}),b(t,L)):(k.find(".richText-initial").hide(),k.find(".richText-editor").show(),b(t,L,!0),e(".richText-toolbar").find("li").removeAttr("data-disable"))}function b(t,a,n){var i=e("#"+t),r=i.siblings(".richText-initial"),o=r.val();if(!a||!o)return{start:0,end:0};if(n===!0)return L={start:i.text().length,end:i.text().length,editorID:t},l(t),!0;a.node=r[0];for(var d={start:!1,end:!1,tag:!1,isTag:!1,tagsCount:0,isHighlight:a.start!==a.end},s=0;s<o.length;s++)"<"===o[s]?(d.isTag=!0,d.tag=!1,d.tagsCount++):d.isTag===!0&&">"!==o[s]?d.tagsCount++:d.isTag===!0&&">"===o[s]?(d.isTag=!1,d.tag=!0,d.tagsCount++):d.tag===!0&&(d.tag=!1),n||(a.start+d.tagsCount<=s&&d.isHighlight&&!d.isTag&&!d.tag&&!d.start?(a.start=s,d.start=!0):!(a.start+d.tagsCount<=s+1)||d.isHighlight||d.isTag||d.tag||d.start||(a.start=s+1,d.start=!0),a.end+d.tagsCount<=s+1&&!d.isTag&&!d.tag&&!d.end&&(a.end=s+1,d.end=!0));return w(a.node,a.start,a.end),a}function w(e,t,a){if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveStart("character",t),n.moveEnd("character",a),n.select(),e.focus()}else e.setSelectionRange?(e.focus(),e.setSelectionRange(t,a)):"undefined"!=typeof e.selectionStart&&(e.selectionStart=t,e.selectionEnd=a,e.focus())}function C(e,t){var a=N(e),n=!1,i=!1;if(!a)return!1;t?"responsive"!==t?t=t.split("x"):(n=!0,t="640x360",t=t.split("x")):(t="640x360",t=t.split("x"));var r="<br><br>";n===!0&&(r+='<div style="position:relative;height:0;padding-bottom:56.25%">');var o="webkitallowfullscreen mozallowfullscreen allowfullscreen";return"YouTube"===a.platform?(r+='<iframe src="https://www.youtube.com/embed/'+a.id+'?ecver=2" width="'+t[0]+'" height="'+t[1]+'" frameborder="0"'+(n===!0?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+o+"></iframe>",i=!0):"Vimeo"===a.platform?(r+='<iframe src="https://player.vimeo.com/video/'+a.id+'" width="'+t[0]+'" height="'+t[1]+'" frameborder="0"'+(n===!0?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+o+"></iframe>",i=!0):"Facebook"===a.platform?(r+='<iframe src="https://www.facebook.com/plugins/video.php?href='+encodeURI(e)+"&show_text=0&width="+t[0]+'" width="'+t[0]+'" height="'+t[1]+'" style="'+(n===!0?'position:absolute;width:100%;height:100%;left:0;border:none;overflow:hidden"':"border:none;overflow:hidden")+'" scrolling="no" frameborder="0" allowTransparency="true" '+o+"></iframe>",i=!0):"Dailymotion"===a.platform&&(r+='<iframe frameborder="0" width="'+t[0]+'" height="'+t[1]+'" src="//www.dailymotion.com/embed/video/'+a.id+'"'+(n===!0?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+o+"></iframe>",i=!0),n===!0&&(r+="</div>"),r+="<br><br>",i?r:!1}function N(e){var t=/(?:http?s?:\/\/)?(?:www\.)?(?:vimeo\.com)\/?(.+)/,a=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,n=/(?:http?s?:\/\/)?(?:www\.)?(?:facebook\.com)\/.*\/videos\/[0-9]+/,i=/(?:http?s?:\/\/)?(?:www\.)?(?:dailymotion\.com)\/video\/([a-zA-Z0-9]+)/,r=e.match(a),o=e.match(t),l=e.match(n),d=e.match(i);return r&&11===r[2].length?{platform:"YouTube",id:r[2]}:o&&o[1]?{platform:"Vimeo",id:o[1]}:l&&l[0]?{platform:"Facebook",id:l[0]}:d&&d[1]?{platform:"Dailymotion",id:d[1]}:!1}function y(){k&&!k.find(".richText-editor").html()&&(R.useParagraph!==!1?k.find(".richText-editor").html("<p><br></p>"):k.find(".richText-editor").html("<div><br></div>"),i())}var R=e.extend({bold:!0,italic:!0,underline:!0,leftAlign:!0,centerAlign:!0,rightAlign:!0,ol:!0,ul:!0,heading:!0,fonts:!0,fontList:["Arial","Arial Black","Comic Sans MS","Courier New","Geneva","Georgia","Helvetica","Impact","Lucida Console","Tahoma","Times New Roman","Verdana"],fontColor:!0,imageUpload:!0,fileUpload:!0,videoEmbed:!0,urls:!0,table:!0,removeStyles:!0,code:!0,colors:[],fileHTML:"",imageHTML:"",useSingleQuotes:!1,height:0,heightPercentage:0,id:"","class":"",useParagraph:!1},t),S=e(this);S.addClass("richText-initial");var k,L,U=e("<ul />"),D=e("<li />"),A=e("<a />",{"class":"richText-btn fa fa-bold","data-command":"bold"}),F=e("<a />",{"class":"richText-btn fa fa-italic","data-command":"italic"}),H=e("<a />",{"class":"richText-btn fa fa-underline","data-command":"underline"}),I=e("<a />",{"class":"richText-btn fa fa-align-left","data-command":"justifyLeft"}),M=e("<a />",{"class":"richText-btn fa fa-align-center","data-command":"justifyCenter"}),B=e("<a />",{"class":"richText-btn fa fa-align-right","data-command":"justifyRight"}),E=e("<a />",{"class":"richText-btn fa fa-list-ol","data-command":"insertOrderedList"}),P=e("<a />",{"class":"richText-btn fa fa-list","data-command":"insertUnorderedList"}),W=e("<a />",{"class":"richText-btn fa fa-header"}),X=e("<a />",{"class":"richText-btn fa fa-font"}),Y=e("<a />",{"class":"richText-btn fa fa-paint-brush"}),Q=e("<a />",{"class":"richText-btn fa fa-image"}),z=e("<a />",{"class":"richText-btn fa fa-video-camera"}),G=e("<a />",{"class":"richText-btn fa fa-file-text-o"}),_=e("<a />",{"class":"richText-btn fa fa-link"}),V=e("<a />",{"class":"richText-btn fa fa-table"}),O=e("<a />",{"class":"richText-btn fa fa-recycle","data-command":"removeFormat"}),j=e("<a />",{"class":"richText-btn fa fa-code","data-command":"toggleCode"}),q=e("<div />",{"class":"richText-dropdown-outer"}),K=e("<span />",{"class":"richText-dropdown-close",html:'<span class="fa fa-times"></span>'}),Z=e("<ul />",{"class":"richText-dropdown"}),$=e("<div />",{"class":"richText-dropdown"}),J=e("<div />",{"class":"richText-form"}),ee=e("<div />",{"class":"richText-form-item"}),te=e("<label />"),ae=e("<input />",{type:"text"}),ne=(e("<input />",{type:"file"}),e("<select />")),ie=e("<button />",{text:"Einfügen","class":"btn"}),re="richText-"+Math.random().toString(36).substring(7),oe=null,le=[],de=0,se=Z.clone();se.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h1">Title #1</a>'})),se.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h2">Title #2</a>'})),se.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h3">Title #3</a>'})),se.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h4">Title #4</a>'})),W.append(q.clone().append(se.prepend(K.clone())));for(var ce=R.fontList,pe=Z.clone(),he=0;he<ce.length;he++)pe.append(e("<li />",{html:'<a style="font-family:'+ce[he]+';" data-command="fontName" data-option="'+ce[he]+'">'+ce[he]+"</a>"}));X.append(q.clone().append(pe.prepend(K.clone())));var fe=Z.clone();fe.html(x("forecolor")),Y.append(q.clone().append(fe.prepend(K.clone())));var ue=$.clone(),me=J.clone().attr("id","richText-URL").attr("data-editor",re);me.append(ee.clone().append(te.clone().text("URL").attr("for","url")).append(ae.clone().attr("id","url"))),me.append(ee.clone().append(te.clone().text("Text").attr("for","urlText")).append(ae.clone().attr("id","urlText"))),me.append(ee.clone().append(te.clone().text("Open in").attr("for","openIn")).append(ne.clone().attr("id","openIn").append(e("<option />",{value:"_self",text:"Same tab"})).append(e("<option />",{value:"_blank",text:"New tab"})))),me.append(ee.clone().append(ie.clone())),ue.append(me),_.append(q.clone().append(ue.prepend(K.clone())));var ge=$.clone(),ve=J.clone().attr("id","richText-Video").attr("data-editor",re);ve.append(ee.clone().append(te.clone().text("URL").attr("for","videoURL")).append(ae.clone().attr("id","videoURL"))),ve.append(ee.clone().append(te.clone().text("Size").attr("for","size")).append(ne.clone().attr("id","size").append(e("<option />",{value:"responsive",text:"Responsive"})).append(e("<option />",{value:"640x360",text:"640x360"})).append(e("<option />",{value:"560x315",text:"560x315"})).append(e("<option />",{value:"480x270",text:"480x270"})).append(e("<option />",{value:"320x180",text:"320x180"})))),ve.append(ee.clone().append(ie.clone())),ge.append(ve),z.append(q.clone().append(ge.prepend(K.clone())));var xe=$.clone(),Te=J.clone().attr("id","richText-Image").attr("data-editor",re);R.imageHTML&&(e(R.imageHTML).find("#imageURL").length>0||"imageURL"===e(R.imageHTML).attr("id"))?Te.html(R.imageHTML):(Te.append(ee.clone().append(te.clone().text("Image URL").attr("for","imageURL")).append(ae.clone().attr("id","imageURL"))),Te.append(ee.clone().append(te.clone().text("Align").attr("for","align")).append(ne.clone().attr("id","align").append(e("<option />",{value:"left",text:"Left"})).append(e("<option />",{value:"center",text:"Center"})).append(e("<option />",{value:"right",text:"Right"}))))),Te.append(ee.clone().append(ie.clone())),xe.append(Te),Q.append(q.clone().append(xe.prepend(K.clone())));var be=$.clone(),we=J.clone().attr("id","richText-File").attr("data-editor",re);R.fileHTML&&(e(R.fileHTML).find("#fileURL").length>0||"fileURL"===e(R.fileHTML).attr("id"))?we.html(R.fileHTML):(we.append(ee.clone().append(te.clone().text("File URL").attr("for","fileURL")).append(ae.clone().attr("id","fileURL"))),we.append(ee.clone().append(te.clone().text("Link text").attr("for","fileText")).append(ae.clone().attr("id","fileText")))),we.append(ee.clone().append(ie.clone())),be.append(we),G.append(q.clone().append(be.prepend(K.clone())));var Ce=$.clone(),Ne=J.clone().attr("id","richText-Table").attr("data-editor",re);return Ne.append(ee.clone().append(te.clone().text("Rows").attr("for","tableRows")).append(ae.clone().attr("id","tableRows").attr("type","number"))),Ne.append(ee.clone().append(te.clone().text("Columns").attr("for","tableColumns")).append(ae.clone().attr("id","tableColumns").attr("type","number"))),Ne.append(ee.clone().append(ie.clone())),Ce.append(Ne),V.append(q.clone().append(Ce.prepend(K.clone()))),a(),k.find(".richText-help").on("click",function(){var t=e(this).parents(".richText");if(t){var a=e("<div />",{"class":"richText-help-popup",style:"position:absolute;top:0;right:0;bottom:0;left:0;background-color: rgba(0,0,0,0.3);"}),n=e("<div />",{style:"position:relative;margin:60px auto;padding:20px;background-color:#FAFAFA;width:70%;font-family:Calibri,Verdana,Helvetica,sans-serif;font-size:small;"}),i=e("<div />",{html:'<span id="closeHelp" style="display:block;position:absolute;top:0;right:0;padding:10px;cursor:pointer;" class="fa fa-times" title="Close"></span>'});i.append('<h3 style="margin:0;">RichText</h3>'),i.append('<hr><br>Powered by <a href="https://github.com/webfashionist/RichText" target="_blank">webfashionist/RichText</a> (Github) <br>License: <a href="https://github.com/webfashionist/RichText/blob/master/LICENSE" target="_blank">AGPL-3.0</a>'),a.append(n.append(i)),t.append(a),a.on("click","#closeHelp",function(){e(this).parents(".richText-help-popup").remove()})}}),e(document).on("click",".richText-undo, .richText-redo",function(t){var a=e(this);a.hasClass("richText-undo")&&!a.hasClass("is-disabled")?f():a.hasClass("richText-redo")&&!a.hasClass("is-disabled")&&u()}),e(document).on("input change blur keydown",".richText-editor",function(t){return 9!==t.keyCode&&"9"!==t.keyCode||"keydown"!==t.type?(y(),i(),void c(e(this).attr("id"))):(t.preventDefault(),d(window,t),!1)}),e(document).on("contextmenu",".richText-editor",function(t){var a=e("<ul />",{"class":"list-rightclick richText-list"}),n=e("<li />");e(".richText-editor").find(".richText-editNode").removeClass("richText-editNode");var i=e(t.target),r=i.parents(".richText"),o=r.find(".richText-toolbar"),l=t.pageX-r.offset().left,d=t.pageY-r.offset().top;return a.css({top:d,left:l}),"A"===i.prop("tagName")?(t.preventDefault(),a.append(n.clone().html('<span class="fa fa-link"></span>')),i.parents(".richText").append(a),a.find(".fa-link").on("click",function(){e(".list-rightclick.richText-list").remove(),i.addClass("richText-editNode");var t=o.find("#richText-URL");t.find("input#url").val(i.attr("href")),t.find("input#urlText").val(i.text()),t.find("input#openIn").val(i.attr("target")),o.find(".fa-link").parent("li").addClass("is-selected")}),!1):"IMG"===i.prop("tagName")?(t.preventDefault(),a.append(n.clone().html('<span class="fa fa-image"></span>')),i.parents(".richText").append(a),a.find(".fa-image").on("click",function(){var t;t=i.parent("div").length>0&&"text-align:center;"===i.parent("div").attr("style")?"center":i.attr("align"),e(".list-rightclick.richText-list").remove(),i.addClass("richText-editNode");var a=o.find("#richText-Image");a.find("input#imageURL").val(i.attr("src")),a.find("input#align").val(t),o.find(".fa-image").parent("li").addClass("is-selected")}),!1):void 0}),e(document).on("input change blur",".richText-initial",function(){R.useSingleQuotes===!0&&e(this).val(v(e(this).val()));var t=e(this).siblings(".richText-editor").attr("id");r(t),c(t)}),e(document).on("dblclick mouseup",".richText-editor",function(){var t=e(this).attr("id");c(t)}),e(document).on("click","#richText-Video button.btn",function(t){t.preventDefault();var a=e(this),n=a.parent(".richText-form-item").parent(".richText-form");if(n.attr("data-editor")===re){var r=n.find("input#videoURL").val(),o=n.find("select#size").val();if(r){var d="";d=C(r,o),d?(R.useSingleQuotes===!0,l(re),g(d),i(),n.find("input#videoURL").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")):(n.prepend(e("<div />",{style:"color:red;display:none;","class":"form-item is-error",text:"Video URL not supported"})),n.children(".form-item.is-error").slideDown(),setTimeout(function(){n.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3))}else n.prepend(e("<div />",{style:"color:red;display:none;","class":"form-item is-error",text:"Please enter an URL"})),n.children(".form-item.is-error").slideDown(),setTimeout(function(){n.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("mousedown",function(t){var a=e(t.target);if(a.hasClass("richText-list")||0!==a.parents(".richText-list").length||(e(".richText-list.list-rightclick").remove(),a.hasClass("richText-form")||0!==a.parents(".richText-form").length||e(".richText-editNode").each(function(){var t=e(this);t.removeClass("richText-editNode"),""===t.attr("class")&&t.removeAttr("class")})),"IMG"===a.prop("tagName")&&a.parents("#"+re)){startX=t.pageX,startY=t.pageY,startW=a.innerWidth(),startH=a.innerHeight();var n=(a.offset().left,a.offset().left+a.innerWidth()),i=a.offset().top+a.innerHeight(),r=(a.offset().top,!1);a.css({cursor:"default"}),startY<=i&&startY>=i-20&&startX>=n-20&&startX<=n&&(oe=a,oe.css({cursor:"nwse-resize"}),r=!0),r!==!0&&!oe||oe.data("width")?r===!0||oe?t.preventDefault():oe=null:(oe.data("width",a.parents("#"+re).innerWidth()),oe.data("height",3*a.parents("#"+re).innerHeight()),t.preventDefault())}}),e(document).mouseup(function(){oe&&oe.css({cursor:"default"}),oe=null}).mousemove(function(e){if(null!==oe){var t=oe.data("width"),a=oe.width(),n=oe.data("height"),r=oe.height();startW+e.pageX-startX<=t&&startH+e.pageY-startY<=n?(oe.innerWidth(startW+e.pageX-startX),i()):startW+e.pageX-startX<=a&&startH+e.pageY-startY<=r&&(oe.innerWidth(startW+e.pageX-startX),i())}}),e(document).on("click","#richText-URL button.btn",function(t){t.preventDefault();var a=e(this),n=a.parent(".richText-form-item").parent(".richText-form");if(n.attr("data-editor")===re){var i=n.find("input#url").val(),r=n.find("input#urlText").val(),o=n.find("#openIn").val();if(o||(o="_self"),r||(r=i),i){var d="";d=R.useSingleQuotes===!0?"<a href='"+i+"' target='"+o+"'>"+r+"</a>":'<a href="'+i+'" target="'+o+'">'+r+"</a>",l(re);var s=e(".richText-editNode");s.length>0&&"A"===s.prop("tagName")?(s.attr("href",i),s.attr("target",o),s.text(r),s.removeClass("richText-editNode"),""===s.attr("class")&&s.removeAttr("class")):g(d),n.find("input#url").val(""),n.find("input#urlText").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}else n.prepend(e("<div />",{style:"color:red;display:none;","class":"form-item is-error",text:"Please enter an URL"})),n.children(".form-item.is-error").slideDown(),setTimeout(function(){n.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("click","#richText-Image button.btn",function(t){t.preventDefault();var a=e(this),n=a.parent(".richText-form-item").parent(".richText-form");if(n.attr("data-editor")===re){var i=n.find("#imageURL").val(),r=n.find("select#align").val();if(r||(r="center"),i){var o="";o=R.useSingleQuotes===!0?"center"===r?"<div style='text-align:center;'><img src='"+i+"'></div>":"<img src='"+i+"' align='"+r+"'>":"center"===r?'<div style="text-align:center;"><img src="'+i+'"></div>':'<img src="'+i+'" align="'+r+'">',l(re);var d=e(".richText-editNode");d.length>0&&"IMG"===d.prop("tagName")?(d.attr("src",i),d.parent("div").length>0&&"text-align:center;"===d.parent("div").attr("style")&&"center"!==r?(d.unwrap("div"),d.attr("align",r)):0!==d.parent("div").length&&"text-align:center;"===d.parent("div").attr("style")||"center"!==r?d.attr("align",r):(d.wrap('<div style="text-align:center;"></div>'),d.removeAttr("align")),d.removeClass("richText-editNode"),""===d.attr("class")&&d.removeAttr("class")):g(o),n.find("input#imageURL").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}else n.prepend(e("<div />",{style:"color:red;display:none;","class":"form-item is-error",text:"Please select an image."})),n.children(".form-item.is-error").slideDown(),setTimeout(function(){n.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("click","#richText-File button.btn",function(t){t.preventDefault();var a=e(this),n=a.parent(".richText-form-item").parent(".richText-form");if(n.attr("data-editor")===re){var i=n.find("#fileURL").val(),r=n.find("#fileText").val();if(r||(r=i),i){var o="";o=R.useSingleQuotes===!0?"<a href='"+i+"' target='_blank'>"+r+"</a>":'<a href="'+i+'" target="_blank">'+r+"</a>",l(re),g(o),n.find("input#fileURL").val(""),n.find("input#fileText").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}else n.prepend(e("<div />",{style:"color:red;display:none;","class":"form-item is-error",text:"Please select a file."})),n.children(".form-item.is-error").slideDown(),setTimeout(function(){n.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("click","#richText-Table button.btn",function(t){t.preventDefault();var a=e(this),n=a.parent(".richText-form-item").parent(".richText-form");if(n.attr("data-editor")===re){var i=n.find("input#tableRows").val(),r=n.find("input#tableColumns").val();(!i||0>=i)&&(i=2),(!r||0>=r)&&(r=2);var o="";o=R.useSingleQuotes===!0?"<table class='table-1'><tbody>":'<table class="table-1"><tbody>';for(var d=1;i>=d;d++){o+="<tr>";for(var s=1;r>=s;s++)o+="<td> </td>";o+="</tr>"}o+="</tbod></table>",l(re),g(o),n.find("input#tableColumns").val(""),n.find("input#tableRows").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}}),e(document).on("click",function(t){var a=e(t.target);if(0===a.parents(".richText-toolbar").length);else if(a.hasClass("richText-dropdown-outer"))a.parent("a").parent("li").removeClass("is-selected");else if(a.find(".richText").length>0)e(".richText-toolbar li").removeClass("is-selected");else if(a.parent().hasClass("richText-dropdown-close"))e(".richText-toolbar li").removeClass("is-selected");else if(a.hasClass("richText-btn")&&e(t.target).children(".richText-dropdown-outer").length>0)if(a.parent("li").addClass("is-selected"),a.hasClass("fa-link")){l(re);var n=s();a.find("input#urlText").val(""),a.find("input#url").val(""),n&&a.find("input#urlText").val(n)}else a.hasClass("fa-image")}),e(document).on("click",".richText-toolbar a[data-command]",function(t){var a=e(this),i=a.closest(".richText-toolbar"),r=i.siblings(".richText-editor"),o=r.attr("id");if(r.length>0&&o===re&&(!a.parent("li").attr("data-disable")||"false"===a.parent("li").attr("data-disable"))){t.preventDefault();var l=e(this).data("command");if("toggleCode"===l)T(r.attr("id"));else{var d=null;e(this).data("option")&&(d=e(this).data("option"),d.match(/^h[1-6]$/)&&(l="heading")),n(l,d),"removeFormat"===l&&n("formatBlock","div")}}a.parents("li.is-selected").removeClass("is-selected")}),e(this)}}(jQuery);